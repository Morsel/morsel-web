<div class="immersive">
  <div ng-class="{'in-story': immersiveState.inStory}">
    <header class="immersive-header user-info">
      <div user-image username="owner.username" user-photos="owner.photos" user-image-size="profile-pic-xs"></div>
      <h1 class="overflow-ellipsis">
        <a ng-click="goTo(owner.username)">{{owner.first_name + ' ' + owner.last_name}}</a>
      </h1>
    </header>
    <div class="story current-story">
      <div story-swipe="{{story.morsels.length > 1}}" story-swipe-count="{{story.morsels.length}}" ng-style="{'height': immersiveHeight}">
        <div class="story-title">
          <h2>{{story.title}}</h2>
        </div>
        <div story-indicators index="currentIndicatorIndex" count="morselsCount"></div>
        <ul class="morsels">
          <li class="cover-page extra-page" ng-style="{'height': immersiveHeight}">
            <div class="story-container">
              <div class="cover-photo-wrap" ng-style="{'background-image': findCoverPhoto(story.morsels, story.primary_morsel_id)}"></div>
              <div class="cover-title-wrap">
                <h2 class="cover-title">{{story.title}}</h2>
              </div>
              <div story-thumbnails index="currentIndicatorIndex" morsels="story.morsels"></div>
              <div class="cover-actions">
                <span><i class="common-like"></i></span>
                <span><i class="common-chat"></i></span>
                <span><i class="common-share"></i></span>
              </div>
              <div class="cover-browse">
                <span>Scroll</span>
                <i class="glyphicon glyphicon-circle-arrow-down"></i>
              </div>
            </div>
          </li>
          <li ng-repeat="morsel in story.morsels" class="morsel" ng-class="{'full-photo': fullPhoto, 'comments-showing': showComments}">
            <div class="story-container">
              <p text-limit class="morsel-description" char-limit="200" text-content="morsel.description"></p>
              <div morsel-actions comments-trigger="showComments" actionable-morsel="morsel"></div>
              <div morsel-comments comments-morsel="morsel" comments-trigger="showComments" is-logged-in="isLoggedIn"></div>
              <div ng-if="morsel.photos" class="morsel-img" href="{{morsel.photos._640x640}}" ng-style="{'background-image': 'url('+morsel.photos._640x640+')', 'height': immersiveHeight}" ng-dblclick="$parent.fullPhoto=!$parent.fullPhoto"></div>
            </div>
          </li>
          <li class="share-page extra-page" ng-style="{'height': immersiveHeight}">
            <div class="story-container">
              <div class="cover-photo-wrap" ng-style="{'background-image':'url('+story.morsels[0].photos._640x640+')'}"></div>
              <div class="cover-title-wrap">
                <h2 class="cover-title">{{story.title}}</h2>
              </div>
              <h5 class="share-this-story h2">Share this Story:</h5>
              <div social-sharing></div>
              <hr />
              <div class="user-info">
                <div user-image username="owner.username" user-photos="owner.photos" user-image-size="profile-pic-m"></div>
                <h4 class="h3">
                  <a ng-click="goTo(owner.username)">{{owner.first_name + ' ' + owner.last_name}}</a>
                </h4>
                <h5>{{owner.title}}</h5>
                <p>{{owner.bio}}</p>
              </header>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>